YUI.add("moodle-availability_date-form",function(e,t){M.availability_date=M.availability_date||{},M.availability_date.form=e.Object(M.core_availability.plugin),M.availability_date.form.init=function(e,t,n){this.initBase(e),this.html=t,this.defaultTime=n},M.availability_date.form.getNode=function(t){var n=M.str.availability_date,r=n.direction_before+' <span class="availability-group">'+'<select name="direction">'+'<option value="&gt;=">'+n.direction_from+"</option>"+'<option value="&lt;">'+n.direction_until+"</option>"+"</select></span> "+this.html,i=e.Node.create("<span>"+r+"</span>");if(t.t!==undefined){i.setData("time",t.t),i.all("select:not([name=direction])").each(function(e){e.set("disabled",!0)});var s=M.cfg.wwwroot+"/availability/condition/date/ajax.php?action=fromtime"+"&time="+t.t;e.io(s,{on:{success:function(t,n,r){var s=e.JSON.parse(n.responseText);for(var o in s){var u=i.one("select[name="+o+"]");u.set("value",s[o]),u.set("disabled",!1)}},failure:function(e,t,n){window.alert(M.str.availability_date.ajaxerror)}}})}else i.setData("time",this.defaultTime);return i.one("select[name=direction]").on("valuechange",function(){M.core_availability.form.update()}),i.all("select:not([name=direction])").each(function(e){e.on("change",function(){M.availability_date.form.updateTime(i)})}),i},M.availability_date.form.updateTime=function(t){var n=M.cfg.wwwroot+"/availability/condition/date/ajax.php?action=totime"+"&year="+t.one("select[name=year]").get("value")+"&month="+t.one("select[name=month]").get("value")+"&day="+t.one("select[name=day]").get("value")+"&hour="+t.one("select[name=hour]").get("value")+"&minute="+t.one("select[name=minute]").get("value");e.io(n,{on:{success:function(e,n,r){t.setData("time",n.responseText),M.core_availability.form.update()},failure:function(e,t,n){window.alert(M.str.availability_date.ajaxerror)}}})},M.availability_date.form.fillValue=function(e,t){e.d=t.one("select[name=direction]").get("value"),e.t=parseInt(t.getData("time"))}},"@VERSION@",{requires:["moodle-core_availability-form","io"]});
